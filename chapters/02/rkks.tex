Kreĭn spaces can be seen as a generalisation of Hilbert spaces, which caters for inner products not being positive definite.
To motivate the need for Kreĭn spaces, we first look at several operations on reproducing kernels and the resulting vector space.

\begin{lemma}[Scaling of kernels]\label{thm:scalingkernels}
  If $h$ is a kernel on $\cX$, and $\lambda \geq 0$ a scalar, then $\lambda h$ is a kernel.
  This yields a scaled RKHS $\cF_\lambda = \{\lambda f \,|\, f \in \cF \}$ with reproducing kernel $\lambda h$, where $\cF$ is the RKHS defined by $h$.
\end{lemma}

\begin{proof}
  Multiplying a positive definite function by a positive constant results in a positive definite function still, and thus defines a unique RKHS.
  The scaling of functions is seen through the fact that $\cF$ is the completion of the space spanned by the kernels, and hence $\cF_\lambda$ by the scaled kernels.
\end{proof}

\begin{lemma}[Sum of kernels]
  If $h_1$ and $h_2$ are kernels on $\cX_1$ and $\cX_2$ respectively, then $h = h_1 + h_2$ is a kernel on $\cX_1 \times \cX_2$.
  Moreover, denote $\cF_1$ and $\cF_2$ the RKHS defined by $h_1$ and $h_2$ respectively.
  Then $\cF = \cF_1 \oplus \cF_2$ is an RKHS defined by $h = h_1 + h_2$, where
  \[
    \cF_1 \oplus \cF_2 = \{ f:\cX_1\times\cX_2 \to\bbR \,|\, f = f_1 + f_2, f_1\in\cF_1 \text{ and } f_2\in\cF_2 \}.
  \]
  For all $f\in\cF$,
  \[
    \norm{f}_\cF^2 = \min_{f_1+f_2=f} \left\{ \norm{f_1}_{\cF_1}^2 + \norm{f_2}_{\cF_2}^2 \right\}.
  \]
\end{lemma}

\begin{proof}
  That $h_1+h_2$ is a kernel should be obvious, as the sum of two positive definite functions is also positive definite.
  For a proof of the remaining statements, see \citet[Theorem 5]{berlinet2011reproducing}.
\end{proof}

\begin{lemma}[Products of kernels]\label{thm:prodkernels}
  Let $\cF_1$ and $\cF_2$ be two RKHS of functions over $\cX_1$ and $\cX_2$, with respective reproducing kernels $h_1$ and $h_2$.
  Then, $h = h_1 h_2$ is a kernel on $\cX_1 \times \cX_2$.
  Moreover, the tensor product space $\cF_1 \otimes \cF_2$ is an RKHS with reproducing kernel $h$.
\end{lemma}

To prove this lemma we introduce the following definition of the \emph{kernel matrix}.

\begin{definition}[Kernel matrix]
  Let $\{x_1,\dots,x_n\}$ be a sample of observed data (covariates), where each $x_i\in\cX$, and $h$ a kernel over this set.
  Define the \emph{kernel matrix} $\bH$ for $h$ as the $n \times n$ matrix with $(i,j)$ entries equal to $h(x_i,x_j)$.
\end{definition}

The kernel matrix is also known as the \emph{Gram matrix}.
By definition, the kernel matrix is a positive-definite matrix: $\ba^\top\bH\ba = \sum_{i=1}^n\sum_{j=1}^n a_ia_jh(x_i,x_j) \geq 0$ for any choice of $a\in\bbR^n$.

\begin{proof}[Proof of Lemma \ref{thm:prodkernels}]
  Fix $n\in\bbN$, and let $\bH_1$ and $\bH_2$ be the kernel matrices for $h_1$ and $h_2$ respectively.
  Since these kernel matrices are symmetric and positive-definite, we can write $\bH_1 = \bB^\top\bB$ and $\bH_1 = \bC^\top\bC$ for some matrices $\bB$ and $\bC$---perform an (orthogonal) eigendecomposition of each of the kernel matrices, and take square roots of the eigenvalues.
  Let $\bH$ be the kernel matrix for $h = h_1h_2$.
  With $x_i = (x_{i1}, x_{i2})$, its $(i,j)$ entries are
  \begin{align*}
    h(x_i,x_j)
    &=h_1(x_{i1},x_{i2}) h_2(x_{j1},x_{j2}) \\
    &= (\bB^\top\bB)_{ij}\cdot (\bC^\top\bC)_{ij} \\
    &= \sum_{k=1}^n b_{ik}b_{jk} \sum_{l=1}^n c_{il}c_{jl},
  \end{align*}
  where we have denoted $b_{ij}$ and $c_{ij}$ to be the $(i,j)$th entries of $\bB$ and $\bC$ respectively 
  Then,
  \begin{align*}
    \sum_{i=1}^n\sum_{j=1}^n h(x_i,x_j)
    &= \sum_{k=1}^n \sum_{l=1}^n \sum_{i=1}^n \sum_{j=1}^n  a_ia_jb_{ik}b_{jk}c_{il}c_{jl} \\
    &= \sum_{k=1}^n \sum_{l=1}^n \left(\sum_{i=1}^n a_i b_{ik} c_{il} \right) \left( \sum_{j=1}^n  a_jb_{jk}c_{jl} \right) \\
    &= \sum_{k=1}^n \sum_{l=1}^n \left(\sum_{i=1}^n a_i b_{ik} c_{il} \right)^2 \\
    &\geq 0
  \end{align*}
  Again, for the remainder of the statement in the lemma, we refer to \citet[Theorem 13]{berlinet2011reproducing}.
\end{proof}

A familiar fact from linear algebra is realised here from Lemmas \ref{thm:scalingkernels}--\ref{thm:prodkernels}: 
1) Multiplying a positive definite matrix by a positive constant results in a positive definite matrix; 
2) the addition of positive definite matrices is a positive definite matrix; and 
3) the \emph{Hadamard product}\footnotemark~of two positive definite matrices is a positive definite matrix.
\footnotetext{The Hadamard product is an element-wise multiplication of two matrices $\bA$ and $\bB$ of identical dimensions, denoted $\bA \circ \bB$. That is, $(\bA \circ \bB)_{ij} = \bA_{ij}\bB_{ij}$.}


What if we want to consider scaling or sum or products of kernels that result in a non-positive definite function?
Will we lose all the nice properties of RKHS?
It turns out no---we just have to switch to Kreĭn spaces.
Krein spaces are inner product spaces endowed with Hilbertian topology, yet their inner products are no longer positive.

\begin{definition}[Negative and indefinite inner products]
  If instead of the positive-definiteness condition for inner products, as per the last item in Definition \ref{def:innerprod}, we have that $\forall f\in\cF$
  \[
    \ip{f,f}_\cF \leq 0,
  \]
  then the inner product is said to be \emph{negative-definite}.
  It is \emph{indefinite} if is is neither positive- nor negative-definite.
\end{definition}


\begin{definition}[Krein space]
  An inner product space $(\cF,\ip{\cdot,\cdot}_\cF)$ is a \emph{Krein space} if there exists two Hilbert spaces $\cF_+$ and $\cF_-$ spanning $\cF$ such that
  \begin{itemize}
    \item All $f\in\cF$ can be decomposed into $f = f_+ + f_-$, where $f_+\in\cF_+$ and $f_- \in \cF_-$.
    \item $\forall f,f'\in\cF$, $\ip{f,f'}_\cF = \ip{f_+,f_+'}_{\cF_+}- \ip{f_-,f_-'}_{\cF_-}$
  \end{itemize}
\end{definition}

This suggests that there is an ``associated'' Hilbert space.

\begin{definition}[Associated Hilbert space]
  Let $\cF$ be a Krein space with decomposition into Hilbert spaces $\cF_+$ and $\cF_-$.
  Denote by $\overline \cF$ the associated Hilbert space defined by
  \[
    \overline \cF = \cF_+ \oplus \cF_-,
  \]
  and hence $\ip{f,f'}_{\overline\cF} = \ip{f_+,f_+'}_{\cF_+} + \ip{f_-,f_-'}_{\cF_-}$.
  Likewise,
  \[
    \overline \cF = \cF_+ \ominus \cF_-,
  \]
  and hence $\ip{f,f'}_{\cF} = \ip{f_+,f_+'}_{\cF_+} - \ip{f_-,f_-'}_{\cF_-}$.
\end{definition}

\begin{definition}[Reproducing kernel Krein space]
  A Krein space $\cF$ of real-valued functions $f:\mathcal X \rightarrow \mathbb R$ on a non-empty set $\mathcal X$ is called a \emph{reproducing kernel Krein space} if the evaluation functional $\delta_x: f \mapsto f(x)$ is continuous on $\cF$, $\forall x \in \cX$, endowed with its strong topology. 
\end{definition}

$\overline\cF$ is the smallest Hilbert space majorizing the Krein space $\cF$.
The strong topology on $\cF$ is the Hilbertian topology of $\overline\cF$.
The topology does not depend on the decomposition chosen.
Clearly $|\ip{f,f}_\cF \leq \norm{f}^2_{\overline\cF}|$ for all $f\in\cF$.

For every reproducing kernel Krein space $\cF$ of functions over a set $\cX$, there corresponds a unique, positive-definite reproducing kernel $\hXXR$.

\begin{lemma}
  Let $\cF$ be an RKKS with $\cF = \cF_+ \ominus \cF_-$.
  Then,
  \begin{itemize}
    \item $\cF_+$ and $\cF_-$ are both RKKS with kernel $h_+$ and $h_-$.
    \item There is a unique symmetric $h(x,x')$ with $h(\cdot,x)\in\cF$ such that for all $f\in\cF$, 
    \[
      \ip{f,h(\cdot,x)}_\cF = f(x)
    \]
    \item $h = h_+ + h_-$.
  \end{itemize}
\end{lemma}

On the other hand, for every positive-definite function $\hXXR$, there corresponds at least one reproducing kernel Hilbert space $\cF$ that has $h$ as its reproducing kernel.

\begin{lemma}
  The following are equivalent.
  \begin{itemize}
    \item There exists (at least) one RKKS with kernel $h$.
    \item $h$ admits a positive decomposition, i.e., there exists two positive kernels $h_+$ and $h_-$ such that $h=h_++h_-$.
    \item $h$ is dominated by some kernel $k$, i.e. $h-k$ is a positive kernel.
  \end{itemize}
\end{lemma}

There is no bijection but a surjection between the set of RKKS and the set of generalized kernels defined in the vector space generated out of the cone of positive kernels.




















